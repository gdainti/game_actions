var Api={call:function(t,n,s,e){var e=e||function(){},t=t||"GET",s=s||{},o=new XMLHttpRequest;o.open(t,n),o.onload=function(){if(200!==o.status)throw new Error("Неверный запрос, status="+o.status);e(JSON.parse(o.responseText))},o.send(s)}};
var App=function(){"use strict";var t={actions:[],currentPoints:0,appendHtml:function(t,i){var n=document.createElement("div");for(n.innerHTML=i;n.children.length>0;)t.appendChild(n.children[0])},formatTime:function(t){Number.prototype.pad=function(t){for(var i=String(this);i.length<(t||2);)i="0"+i;return i};var i=Math.floor(t/60),n=t-60*i;return i.pad()+":"+n.pad()},setTime:function(t,i){var n=t.getElementsByClassName("js-action-time");n[0].innerHTML=this.formatTime(i)},showAction:function(t){var i=['<div id="js-action-{id}" title="{title}" class="js-action-click action action--{id}" data-id="{id}" onclick="App.actionClick(this)">','<div class="action__image"></div>','<div class="js-action-time action__time"></div>',"</div>"].join("");i=i.replace(/{[^{}]+}/g,function(i){return t[i.replace(/[{}]+/g,"")]||""}),this.appendHtml(document.getElementById("js-actions"),i)},getActionById:function(i){for(var n=0;n<t.actions.length;n++)if(t.actions[n].id==i)return t.actions[n];return!1},updatePoints:function(i){t.currentPoints=i;var n=document.getElementById("js-current-points");n.innerHTML=i},actionClick:function(i){var n=i.getAttribute("data-id"),e=t.getActionById(n);e.active===!0&&t.makeAction(i,e)},makeAction:function(i,n){var e=t.currentPoints+n.points;Api.call("POST","api/index.php","points="+e,function(){t.updatePoints(e),t.disableAction(i,n)})},disableAction:function(i,n){n.active=!1,Class.addClass(i,"action--inactive"),t.setTime(i,n.recovery_time);var e=n.recovery_time,c=setInterval(function(){e>1?(e--,t.setTime(i,e)):(t.enableAction(i,n),clearTimeout(c))},1e3)},enableAction:function(t,i){i.active=!0,Class.removeClass(t,"action--inactive")},init:function(){Api.call("GET","api/index.php",{},function(i){if("ok"==i.status&&i.current_points&&i.actions){t.actions=i.actions,t.updatePoints(i.current_points);for(var n=0;n<t.actions.length;n++)t.actions[n].active=!0,t.showAction(t.actions[n])}})}};return t.init(),{actionClick:t.actionClick}}();
var Class=function(){return{hasClass:function(s,a){return!!s.className.match(new RegExp("(\\s|^)"+a+"(\\s|$)"))},addClass:function(s,a){this.hasClass(s,a)||(s.className+=" "+a)},removeClass:function(s,a){if(this.hasClass(s,a)){var e=new RegExp("(\\s|^)"+a+"(\\s|$)");s.className=s.className.replace(e," ")}}}}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwaS5qcyIsImFwcC5qcyIsImNsYXNzLmpzIl0sIm5hbWVzIjpbIkFwaSIsImNhbGwiLCJtZXRob2QiLCJ1cmwiLCJkYXRhIiwiY2FsbGJhY2siLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsIm9wZW4iLCJvbmxvYWQiLCJzdGF0dXMiLCJFcnJvciIsIkpTT04iLCJwYXJzZSIsInJlc3BvbnNlVGV4dCIsInNlbmQiLCJBcHAiLCJBY3Rpb25zIiwiYWN0aW9ucyIsImN1cnJlbnRQb2ludHMiLCJhcHBlbmRIdG1sIiwiZWwiLCJzdHIiLCJkaXYiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lckhUTUwiLCJjaGlsZHJlbiIsImxlbmd0aCIsImFwcGVuZENoaWxkIiwiZm9ybWF0VGltZSIsInRvdGFsIiwiTnVtYmVyIiwicHJvdG90eXBlIiwicGFkIiwic2l6ZSIsInMiLCJTdHJpbmciLCJ0aGlzIiwibWludXRlIiwiTWF0aCIsImZsb29yIiwic2Vjb25kcyIsInNldFRpbWUiLCJhY3Rpb25FbGVtZW50IiwidGltZSIsInRpbWVFbGVtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsInNob3dBY3Rpb24iLCJhY3Rpb24iLCJ0ZW1wbGF0ZSIsImpvaW4iLCJyZXBsYWNlIiwia2V5IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRBY3Rpb25CeUlkIiwiYWN0aW9uSWQiLCJpIiwiaWQiLCJ1cGRhdGVQb2ludHMiLCJwb2ludHMiLCJwb2ludEVsZW1lbnQiLCJhY3Rpb25DbGljayIsImdldEF0dHJpYnV0ZSIsImFjdGl2ZSIsIm1ha2VBY3Rpb24iLCJkaXNhYmxlQWN0aW9uIiwiQ2xhc3MiLCJhZGRDbGFzcyIsInJlY292ZXJ5X3RpbWUiLCJ0aW1lTGVmdCIsInRpbWVvdXQiLCJzZXRJbnRlcnZhbCIsImVuYWJsZUFjdGlvbiIsImNsZWFyVGltZW91dCIsInJlbW92ZUNsYXNzIiwiaW5pdCIsImN1cnJlbnRfcG9pbnRzIiwiaGFzQ2xhc3MiLCJlbGUiLCJj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QUFNUSxZQUFZL0IsRUFBZSxxQkFHckNnQyxLQUFNLFdBQ0Y1RSxJQUFJQyxLQUFLLE1BQU8sbUJBQXFCLFNBQVNHLEdBQzFDLEdBQW1CLE1BQWZBLEVBQUtNLFFBQWtCTixFQUFLeUUsZ0JBQWtCekUsRUFBS2MsUUFBUyxDQUM1REQsRUFBUUMsUUFBVWQsRUFBS2MsUUFDdkJELEVBQVEwQyxhQUFhdkQsRUFBS3lFLGVBRTFCLEtBQUssR0FBSXBCLEdBQUksRUFBR0EsRUFBSXhDLEVBQVFDLFFBQVFVLE9BQVE2QixJQUN4Q3hDLEVBQVFDLFFBQVF1QyxHQUFHTyxRQUFTLEVBQzVCL0MsRUFBUStCLFdBQVcvQixFQUFRQyxRQUFRdUMsUUFTdkQsT0FGQXhDLEdBQVEyRCxRQUdKZCxZQUFhN0MsRUFBUTZDO0FDOUg3QixHQUFJSyxPQUFRLFdBRVIsT0FFSVcsU0FBVSxTQUFVQyxFQUFJQyxHQUNwQixRQUFTRCxFQUFJRSxVQUFVQyxNQUFNLEdBQUlDLFFBQU8sVUFBVUgsRUFBSSxhQUcxRFosU0FBVSxTQUFTVyxFQUFJQyxHQUNkMUMsS0FBS3dDLFNBQVNDLEVBQUlDLEtBQU1ELEVBQUlFLFdBQWEsSUFBSUQsSUFHdERMLFlBQWEsU0FBU0ksRUFBSUMsR0FDdEIsR0FBSTFDLEtBQUt3QyxTQUFTQyxFQUFJQyxHQUFNLENBQ3hCLEdBQUlJLEdBQU0sR0FBSUQsUUFBTyxVQUFVSCxFQUFJLFVBQ25DRCxHQUFJRSxVQUFVRixFQUFJRSxVQUFVN0IsUUFBUWdDLEVBQUkiLCJmaWxlIjoic2NyaXB0LmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIEFwaSA9IHtcclxuXHJcbiAgICBjYWxsOiBmdW5jdGlvbihtZXRob2QsIHVybCwgZGF0YSwgY2FsbGJhY2spIHtcclxuXHJcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgZnVuY3Rpb24oKSB7fTtcclxuICAgICAgICB2YXIgbWV0aG9kID0gbWV0aG9kIHx8ICdHRVQnO1xyXG4gICAgICAgIHZhciBkYXRhID0gZGF0YSB8fCB7fTtcclxuXHJcbiAgICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgICAgIHhoci5vcGVuKG1ldGhvZCwgdXJsKTtcclxuICAgICAgICB4aHIub25sb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfQndC10LLQtdGA0L3Ri9C5INC30LDQv9GA0L7RgSwgc3RhdHVzPScgKyB4aHIuc3RhdHVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHhoci5zZW5kKGRhdGEpO1xyXG4gICAgfVxyXG59OyIsInZhciBBcHAgPSAoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIEFjdGlvbnMgPSB7XHJcblxyXG4gICAgICAgIGFjdGlvbnM6IFtdLFxyXG4gICAgICAgIGN1cnJlbnRQb2ludHM6IDAsXHJcblxyXG4gICAgICAgIGFwcGVuZEh0bWw6IGZ1bmN0aW9uKGVsLCBzdHIpIHtcclxuICAgICAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBkaXYuaW5uZXJIVE1MID0gc3RyO1xyXG4gICAgICAgICAgICB3aGlsZSAoZGl2LmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGVsLmFwcGVuZENoaWxkKGRpdi5jaGlsZHJlblswXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBmb3JtYXRUaW1lOiBmdW5jdGlvbih0b3RhbCkge1xyXG5cclxuICAgICAgICAgICAgTnVtYmVyLnByb3RvdHlwZS5wYWQgPSBmdW5jdGlvbihzaXplKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcyA9IFN0cmluZyh0aGlzKTtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChzLmxlbmd0aCA8IChzaXplIHx8IDIpKSB7cyA9IFwiMFwiICsgczt9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcztcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHZhciBtaW51dGUgPSBNYXRoLmZsb29yKHRvdGFsLzYwKTtcclxuICAgICAgICAgICAgdmFyIHNlY29uZHMgPSB0b3RhbCAtIChtaW51dGUqNjApO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG1pbnV0ZS5wYWQoKSArICc6JyArIHNlY29uZHMucGFkKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgc2V0VGltZTogZnVuY3Rpb24oYWN0aW9uRWxlbWVudCwgdGltZSkge1xyXG4gICAgICAgICAgICB2YXIgdGltZUVsZW1lbnQgPSBhY3Rpb25FbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2pzLWFjdGlvbi10aW1lJyk7XHJcbiAgICAgICAgICAgIHRpbWVFbGVtZW50WzBdLmlubmVySFRNTCA9IHRoaXMuZm9ybWF0VGltZSh0aW1lKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzaG93QWN0aW9uOiBmdW5jdGlvbihhY3Rpb24pIHtcclxuICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gW1xyXG4gICAgICAgICAgICAgICAgJzxkaXYgaWQ9XCJqcy1hY3Rpb24te2lkfVwiIHRpdGxlPVwie3RpdGxlfVwiIGNsYXNzPVwianMtYWN0aW9uLWNsaWNrIGFjdGlvbiBhY3Rpb24tLXtpZH1cIiBkYXRhLWlkPVwie2lkfVwiIG9uY2xpY2s9XCJBcHAuYWN0aW9uQ2xpY2sodGhpcylcIj4nLFxyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiYWN0aW9uX19pbWFnZVwiPjwvZGl2PicsXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJqcy1hY3Rpb24tdGltZSBhY3Rpb25fX3RpbWVcIj48L2Rpdj4nLFxyXG4gICAgICAgICAgICAgICAgJzwvZGl2PidcclxuICAgICAgICAgICAgXS5qb2luKCcnKTtcclxuXHJcbiAgICAgICAgICAgIHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZSgve1tee31dK30vZywgZnVuY3Rpb24oa2V5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uW2tleS5yZXBsYWNlKC9be31dKy9nLCBcIlwiKV0gfHwgXCJcIjtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmFwcGVuZEh0bWwoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2pzLWFjdGlvbnMnKSwgdGVtcGxhdGUpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGdldEFjdGlvbkJ5SWQ6IGZ1bmN0aW9uKGFjdGlvbklkKSB7XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEFjdGlvbnMuYWN0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKEFjdGlvbnMuYWN0aW9uc1tpXS5pZCA9PSBhY3Rpb25JZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBBY3Rpb25zLmFjdGlvbnNbaV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHVwZGF0ZVBvaW50czogZnVuY3Rpb24ocG9pbnRzKSB7XHJcbiAgICAgICAgICAgIEFjdGlvbnMuY3VycmVudFBvaW50cyA9IHBvaW50cztcclxuICAgICAgICAgICAgdmFyIHBvaW50RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdqcy1jdXJyZW50LXBvaW50cycpO1xyXG4gICAgICAgICAgICBwb2ludEVsZW1lbnQuaW5uZXJIVE1MID0gcG9pbnRzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGFjdGlvbkNsaWNrOiBmdW5jdGlvbihhY3Rpb25FbGVtZW50KSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgYWN0aW9uSWQgPSBhY3Rpb25FbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpO1xyXG4gICAgICAgICAgICB2YXIgYWN0aW9uID0gQWN0aW9ucy5nZXRBY3Rpb25CeUlkKGFjdGlvbklkKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChhY3Rpb24uYWN0aXZlID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBBY3Rpb25zLm1ha2VBY3Rpb24oYWN0aW9uRWxlbWVudCwgYWN0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG1ha2VBY3Rpb246IGZ1bmN0aW9uKGFjdGlvbkVsZW1lbnQsIGFjdGlvbikge1xyXG5cclxuICAgICAgICAgICAgdmFyIHBvaW50cyA9IEFjdGlvbnMuY3VycmVudFBvaW50cyArIGFjdGlvbi5wb2ludHM7XHJcbiAgICAgICAgICAgIEFwaS5jYWxsKCdQT1NUJywnYXBpL2luZGV4LnBocCcsICdwb2ludHM9Jytwb2ludHMsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgQWN0aW9ucy51cGRhdGVQb2ludHMocG9pbnRzKTtcclxuICAgICAgICAgICAgICAgIEFjdGlvbnMuZGlzYWJsZUFjdGlvbihhY3Rpb25FbGVtZW50LCBhY3Rpb24pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBkaXNhYmxlQWN0aW9uOiBmdW5jdGlvbihhY3Rpb25FbGVtZW50LCBhY3Rpb24pIHtcclxuICAgICAgICAgICAgYWN0aW9uLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBDbGFzcy5hZGRDbGFzcyhhY3Rpb25FbGVtZW50LCAnYWN0aW9uLS1pbmFjdGl2ZScpO1xyXG4gICAgICAgICAgICBBY3Rpb25zLnNldFRpbWUoYWN0aW9uRWxlbWVudCwgYWN0aW9uLnJlY292ZXJ5X3RpbWUpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHRpbWVMZWZ0ID0gYWN0aW9uLnJlY292ZXJ5X3RpbWU7XHJcblxyXG4gICAgICAgICAgICB2YXIgdGltZW91dCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aW1lTGVmdCA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aW1lTGVmdC0tO1xyXG4gICAgICAgICAgICAgICAgICAgIEFjdGlvbnMuc2V0VGltZShhY3Rpb25FbGVtZW50LCB0aW1lTGVmdCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIEFjdGlvbnMuZW5hYmxlQWN0aW9uKGFjdGlvbkVsZW1lbnQsIGFjdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBlbmFibGVBY3Rpb246IGZ1bmN0aW9uKGFjdGlvbkVsZW1lbnQsIGFjdGlvbikge1xyXG4gICAgICAgICAgICBhY3Rpb24uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgQ2xhc3MucmVtb3ZlQ2xhc3MoYWN0aW9uRWxlbWVudCwgJ2FjdGlvbi0taW5hY3RpdmUnKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgQXBpLmNhbGwoJ0dFVCcsICdhcGkvaW5kZXgucGhwJywge30sIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSAnb2snICYmIGRhdGEuY3VycmVudF9wb2ludHMgJiYgZGF0YS5hY3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgQWN0aW9ucy5hY3Rpb25zID0gZGF0YS5hY3Rpb25zO1xyXG4gICAgICAgICAgICAgICAgICAgIEFjdGlvbnMudXBkYXRlUG9pbnRzKGRhdGEuY3VycmVudF9wb2ludHMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEFjdGlvbnMuYWN0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBBY3Rpb25zLmFjdGlvbnNbaV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQWN0aW9ucy5zaG93QWN0aW9uKEFjdGlvbnMuYWN0aW9uc1tpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIEFjdGlvbnMuaW5pdCgpO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgYWN0aW9uQ2xpY2s6IEFjdGlvbnMuYWN0aW9uQ2xpY2tcclxuICAgIH1cclxuXHJcbn0pKCk7IiwidmFyIENsYXNzID0gKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHJldHVybiB7XHJcblxyXG4gICAgICAgIGhhc0NsYXNzOiBmdW5jdGlvbiAoZWxlLGNscykge1xyXG4gICAgICAgICAgICByZXR1cm4gISFlbGUuY2xhc3NOYW1lLm1hdGNoKG5ldyBSZWdFeHAoJyhcXFxcc3xeKScrY2xzKycoXFxcXHN8JCknKSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKGVsZSxjbHMpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmhhc0NsYXNzKGVsZSxjbHMpKSBlbGUuY2xhc3NOYW1lICs9IFwiIFwiK2NscztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZW1vdmVDbGFzczogZnVuY3Rpb24oZWxlLGNscykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5oYXNDbGFzcyhlbGUsY2xzKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoJyhcXFxcc3xeKScrY2xzKycoXFxcXHN8JCknKTtcclxuICAgICAgICAgICAgICAgIGVsZS5jbGFzc05hbWU9ZWxlLmNsYXNzTmFtZS5yZXBsYWNlKHJlZywnICcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KSgpO1xyXG5cclxuXHJcblxyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
