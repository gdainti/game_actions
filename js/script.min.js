var Api={call:function(t,n,s,e){var e=e||function(){},t=t||"GET",o=new XMLHttpRequest;o.open(t,n),o.onload=function(){if(200!==o.status)throw new Error("Неверный запрос, status="+o.status);e(JSON.parse(o.responseText))},o.send()}};
var App=function(){"use strict";var t={actions:[],currentPoints:0,appendHtml:function(t,i){var n=document.createElement("div");for(n.innerHTML=i;n.children.length>0;)t.appendChild(n.children[0])},formatTime:function(t){Number.prototype.pad=function(t){for(var i=String(this);i.length<(t||2);)i="0"+i;return i};var i=Math.floor(t/60),n=t-60*i;return i.pad()+":"+n.pad()},setTime:function(t,i){var n=t.getElementsByClassName("js-action-time");n[0].innerHTML=this.formatTime(i)},showAction:function(t){var i=['<div id="js-action-{id}" title="{title}" class="js-action-click action action--{id}" data-id="{id}" onclick="App.actionClick(this)">','<div class="action__image"></div>','<div class="js-action-time action__time"></div>',"</div>"].join("");i=i.replace(/{[^{}]+}/g,function(i){return t[i.replace(/[{}]+/g,"")]||""}),this.appendHtml(document.getElementById("js-actions"),i)},getActionById:function(i){for(var n=0;n<t.actions.length;n++)if(t.actions[n].id==i)return t.actions[n];return!1},setPoints:function(t,i){Api.call("POST","api/index.php","points="+t,i)},updatePoints:function(i){t.currentPoints=i;var n=document.getElementById("js-current-points");n.innerHTML=i},actionClick:function(i){var n=i.getAttribute("data-id"),e=t.getActionById(n);e.active===!0&&t.makeAction(i,e)},makeAction:function(i,n){var e=t.currentPoints+n.points;t.setPoints(e,function(){t.updatePoints(e),t.disableAction(i,n)})},disableAction:function(i,n){n.active=!1,Class.addClass(i,"action--inactive"),t.setTime(i,n.recovery_time);var e=n.recovery_time,c=setInterval(function(){e>1?(e--,t.setTime(i,e)):(t.enableAction(i,n),clearTimeout(c))},1e3)},enableAction:function(t,i){i.active=!0,Class.removeClass(t,"action--inactive")},init:function(){Api.call("GET","api/index.php",{},function(i){if("ok"==i.status&&i.current_points&&i.actions){t.actions=i.actions,t.updatePoints(i.current_points);for(var n=0;n<t.actions.length;n++)t.actions[n].active=!0,t.showAction(t.actions[n])}})}};return t.init(),{actionClick:t.actionClick}}();
var Class=function(){return{hasClass:function(s,a){return!!s.className.match(new RegExp("(\\s|^)"+a+"(\\s|$)"))},addClass:function(s,a){this.hasClass(s,a)||(s.className+=" "+a)},removeClass:function(s,a){if(this.hasClass(s,a)){var e=new RegExp("(\\s|^)"+a+"(\\s|$)");s.className=s.className.replace(e," ")}}}}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwaS5qcyIsImFwcC5qcyIsImNsYXNzLmpzIl0sIm5hbWVzIjpbIkFwaSIsImNhbGwiLCJtZXRob2QiLCJ1cmwiLCJkYXRhIiwiY2FsbGJhY2siLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsIm9wZW4iLCJvbmxvYWQiLCJzdGF0dXMiLCJFcnJvciIsIkpTT04iLCJwYXJzZSIsInJlc3BvbnNlVGV4dCIsInNlbmQiLCJBcHAiLCJBY3Rpb25zIiwiYWN0aW9ucyIsImN1cnJlbnRQb2ludHMiLCJhcHBlbmRIdG1sIiwiZWwiLCJzdHIiLCJkaXYiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lckhUTUwiLCJjaGlsZHJlbiIsImxlbmd0aCIsImFwcGVuZENoaWxkIiwiZm9ybWF0VGltZSIsInRvdGFsIiwiTnVtYmVyIiwicHJvdG90eXBlIiwicGFkIiwic2l6ZSIsInMiLCJTdHJpbmciLCJ0aGlzIiwibWludXRlIiwiTWF0aCIsImZsb29yIiwic2Vjb25kcyIsInNldFRpbWUiLCJhY3Rpb25FbGVtZW50IiwidGltZSIsInRpbWVFbGVtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsInNob3dBY3Rpb24iLCJhY3Rpb24iLCJ0ZW1wbGF0ZSIsImpvaW4iLCJyZXBsYWNlIiwia2V5IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRBY3Rpb25CeUlkIiwiYWN0aW9uSWQiLCJpIiwiaWQiLCJzZXRQb2ludHMiLCJjdXJyZW50IiwidXBkYXRlUG9pbnRzIiwicG9pbnRzIiwicG9pbnRFbGVtZW50IiwiYWN0aW9uQ2xpY2siLCJnZXRBdHRyaWJ1dGUiLCJhY3RpdmUiLCJtYWtlQWN0aW9uIiwiZGlzYWJsZUFjdGlvbiIsIkNsYXNzIiwiYWRkQ2xhc3MiLCJyZWNvdmVyeV90aW1lIiwidGltZUxlZnQiLCJ0aW1lb3V0Iiwic2V0SW50ZXJ2YWwiLCJlbmFibGVBY3Rpb24iLCJjbGVhclRpbWVvdXQiLCJyZW1vdmVDbGFzcyIsImluaXQiLCJjdXJyZW50X3BvaW50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YUgsS0FFbEIsTUFHUEUsYUFBYyxTQUFTL0IsRUFBZUssR0FDbENBLEVBQU9pQixRQUFTLEVBQ2hCRyxNQUFNUSxZQUFZakMsRUFBZSxxQkFHckNrQyxLQUFNLFdBQ0Y5RSxJQUFJQyxLQUFLLE1BQU8sbUJBQXFCLFNBQVNHLEdBQzFDLEdBQW1CLE1BQWZBLEVBQUtNLFFBQWtCTixFQUFLMkUsZ0JBQWtCM0UsRUFBS2MsUUFBUyxDQUM1REQsRUFBUUMsUUFBVWQsRUFBS2MsUUFDdkJELEVBQVE0QyxhQUFhekQsRUFBSzJFLGVBRTFCLEtBQUssR0FBSXRCLEdBQUksRUFBR0EsRUFBSXhDLEVBQVFDLFFBQVFVLE9BQVE2QixJQUN4Q3hDLEVBQVFDLFFBQVF1QyxHQUFHUyxRQUFTLEVBQzVCakQsRUFBUStCLFdBQVcvQixFQUFRQyxRQUFRdUMsUUFTdkQsT0FGQXhDLEdBQVE2RCxRQUdKZCxZQUFhL0MsRUFBUStDO0FDcEk3QixHQUFJSyxPQUFRLFdBRVIsT0FFSVcsU0FBVSxTQUFVQyxFQUFJQyxHQUNwQixRQUFTRCxFQUFJRSxVQUFVQyxNQUFNLEdBQUlDLFFBQU8sVUFBVUgsRUFBSSxhQUcxRFosU0FBVSxTQUFTVyxFQUFJQyxHQUNkNUMsS0FBSzBDLFNBQVNDLEVBQUlDLEtBQU1ELEVBQUlFLFdBQWEsSUFBSUQsSUFHdERMLFlBQWEsU0FBU0ksRUFBSUMsR0FDdEIsR0FBSTVDLEtBQUswQyxTQUFTQyxFQUFJQyxHQUFNLENBQ3hCLEdBQUlJLEdBQU0sR0FBSUQsUUFBTyxVQUFVSCxFQUFJLFVBQ25DRCxHQUFJRSxVQUFVRixFQUFJRSxVQUFVL0IsUUFBUWtDLEVBQUkiLCJmaWxlIjoic2NyaXB0LmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIEFwaSA9IHtcclxuXHJcbiAgICBjYWxsOiBmdW5jdGlvbihtZXRob2QsIHVybCwgZGF0YSwgY2FsbGJhY2spIHtcclxuXHJcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgZnVuY3Rpb24oKSB7fTtcclxuICAgICAgICB2YXIgbWV0aG9kID0gbWV0aG9kIHx8ICdHRVQnO1xyXG4gICAgICAgIHZhciBkYXRhID0gZGF0YSB8fCB7fTtcclxuXHJcbiAgICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgICAgIHhoci5vcGVuKG1ldGhvZCwgdXJsKTtcclxuICAgICAgICB4aHIub25sb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfQndC10LLQtdGA0L3Ri9C5INC30LDQv9GA0L7RgSwgc3RhdHVzPScgKyB4aHIuc3RhdHVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHhoci5zZW5kKCk7XHJcbiAgICB9XHJcbn07IiwidmFyIEFwcCA9IChmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgQWN0aW9ucyA9IHtcclxuXHJcbiAgICAgICAgYWN0aW9uczogW10sXHJcbiAgICAgICAgY3VycmVudFBvaW50czogMCxcclxuXHJcbiAgICAgICAgYXBwZW5kSHRtbDogZnVuY3Rpb24oZWwsIHN0cikge1xyXG4gICAgICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSBzdHI7XHJcbiAgICAgICAgICAgIHdoaWxlIChkaXYuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZWwuYXBwZW5kQ2hpbGQoZGl2LmNoaWxkcmVuWzBdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGZvcm1hdFRpbWU6IGZ1bmN0aW9uKHRvdGFsKSB7XHJcblxyXG4gICAgICAgICAgICBOdW1iZXIucHJvdG90eXBlLnBhZCA9IGZ1bmN0aW9uKHNpemUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzID0gU3RyaW5nKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKHMubGVuZ3RoIDwgKHNpemUgfHwgMikpIHtzID0gXCIwXCIgKyBzO31cclxuICAgICAgICAgICAgICAgIHJldHVybiBzO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdmFyIG1pbnV0ZSA9IE1hdGguZmxvb3IodG90YWwvNjApO1xyXG4gICAgICAgICAgICB2YXIgc2Vjb25kcyA9IHRvdGFsIC0gKG1pbnV0ZSo2MCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbWludXRlLnBhZCgpICsgJzonICsgc2Vjb25kcy5wYWQoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzZXRUaW1lOiBmdW5jdGlvbihhY3Rpb25FbGVtZW50LCB0aW1lKSB7XHJcbiAgICAgICAgICAgIHZhciB0aW1lRWxlbWVudCA9IGFjdGlvbkVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnanMtYWN0aW9uLXRpbWUnKTtcclxuICAgICAgICAgICAgdGltZUVsZW1lbnRbMF0uaW5uZXJIVE1MID0gdGhpcy5mb3JtYXRUaW1lKHRpbWUpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNob3dBY3Rpb246IGZ1bmN0aW9uKGFjdGlvbikge1xyXG4gICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSBbXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBpZD1cImpzLWFjdGlvbi17aWR9XCIgdGl0bGU9XCJ7dGl0bGV9XCIgY2xhc3M9XCJqcy1hY3Rpb24tY2xpY2sgYWN0aW9uIGFjdGlvbi0te2lkfVwiIGRhdGEtaWQ9XCJ7aWR9XCIgb25jbGljaz1cIkFwcC5hY3Rpb25DbGljayh0aGlzKVwiPicsXHJcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhY3Rpb25fX2ltYWdlXCI+PC9kaXY+JyxcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImpzLWFjdGlvbi10aW1lIGFjdGlvbl9fdGltZVwiPjwvZGl2PicsXHJcbiAgICAgICAgICAgICAgICAnPC9kaXY+J1xyXG4gICAgICAgICAgICBdLmpvaW4oJycpO1xyXG5cclxuICAgICAgICAgICAgdGVtcGxhdGUgPSB0ZW1wbGF0ZS5yZXBsYWNlKC97W157fV0rfS9nLCBmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25ba2V5LnJlcGxhY2UoL1t7fV0rL2csIFwiXCIpXSB8fCBcIlwiO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuYXBwZW5kSHRtbChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnanMtYWN0aW9ucycpLCB0ZW1wbGF0ZSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZ2V0QWN0aW9uQnlJZDogZnVuY3Rpb24oYWN0aW9uSWQpIHtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgQWN0aW9ucy5hY3Rpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoQWN0aW9ucy5hY3Rpb25zW2ldLmlkID09IGFjdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFjdGlvbnMuYWN0aW9uc1tpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgc2V0UG9pbnRzOiBmdW5jdGlvbihjdXJyZW50LCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAvLyB1cGRhdGUgY3VycmVudF9wb2ludHMgb24gYmFja2VuZFxyXG4gICAgICAgICAgICBBcGkuY2FsbCgnUE9TVCcsJ2FwaS9pbmRleC5waHAnLCAncG9pbnRzPScrY3VycmVudCwgY2FsbGJhY2spO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHVwZGF0ZVBvaW50czogZnVuY3Rpb24ocG9pbnRzKSB7XHJcbiAgICAgICAgICAgIEFjdGlvbnMuY3VycmVudFBvaW50cyA9IHBvaW50cztcclxuICAgICAgICAgICAgdmFyIHBvaW50RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdqcy1jdXJyZW50LXBvaW50cycpO1xyXG4gICAgICAgICAgICBwb2ludEVsZW1lbnQuaW5uZXJIVE1MID0gcG9pbnRzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGFjdGlvbkNsaWNrOiBmdW5jdGlvbihhY3Rpb25FbGVtZW50KSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgYWN0aW9uSWQgPSBhY3Rpb25FbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpO1xyXG4gICAgICAgICAgICB2YXIgYWN0aW9uID0gQWN0aW9ucy5nZXRBY3Rpb25CeUlkKGFjdGlvbklkKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChhY3Rpb24uYWN0aXZlID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBBY3Rpb25zLm1ha2VBY3Rpb24oYWN0aW9uRWxlbWVudCwgYWN0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG1ha2VBY3Rpb246IGZ1bmN0aW9uKGFjdGlvbkVsZW1lbnQsIGFjdGlvbikge1xyXG5cclxuICAgICAgICAgICAgdmFyIHBvaW50cyA9IEFjdGlvbnMuY3VycmVudFBvaW50cyArIGFjdGlvbi5wb2ludHM7XHJcbiAgICAgICAgICAgIEFjdGlvbnMuc2V0UG9pbnRzKHBvaW50cywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBBY3Rpb25zLnVwZGF0ZVBvaW50cyhwb2ludHMpO1xyXG4gICAgICAgICAgICAgICAgQWN0aW9ucy5kaXNhYmxlQWN0aW9uKGFjdGlvbkVsZW1lbnQsIGFjdGlvbik7XHJcbiAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGRpc2FibGVBY3Rpb246IGZ1bmN0aW9uKGFjdGlvbkVsZW1lbnQsIGFjdGlvbikge1xyXG4gICAgICAgICAgICBhY3Rpb24uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIENsYXNzLmFkZENsYXNzKGFjdGlvbkVsZW1lbnQsICdhY3Rpb24tLWluYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIEFjdGlvbnMuc2V0VGltZShhY3Rpb25FbGVtZW50LCBhY3Rpb24ucmVjb3ZlcnlfdGltZSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgdGltZUxlZnQgPSBhY3Rpb24ucmVjb3ZlcnlfdGltZTtcclxuXHJcbiAgICAgICAgICAgIHZhciB0aW1lb3V0ID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRpbWVMZWZ0ID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpbWVMZWZ0LS07XHJcbiAgICAgICAgICAgICAgICAgICAgQWN0aW9ucy5zZXRUaW1lKGFjdGlvbkVsZW1lbnQsIHRpbWVMZWZ0KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgQWN0aW9ucy5lbmFibGVBY3Rpb24oYWN0aW9uRWxlbWVudCwgYWN0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGVuYWJsZUFjdGlvbjogZnVuY3Rpb24oYWN0aW9uRWxlbWVudCwgYWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGFjdGlvbi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBDbGFzcy5yZW1vdmVDbGFzcyhhY3Rpb25FbGVtZW50LCAnYWN0aW9uLS1pbmFjdGl2ZScpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBBcGkuY2FsbCgnR0VUJywgJ2FwaS9pbmRleC5waHAnLCB7fSwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09ICdvaycgJiYgZGF0YS5jdXJyZW50X3BvaW50cyAmJiBkYXRhLmFjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBBY3Rpb25zLmFjdGlvbnMgPSBkYXRhLmFjdGlvbnM7XHJcbiAgICAgICAgICAgICAgICAgICAgQWN0aW9ucy51cGRhdGVQb2ludHMoZGF0YS5jdXJyZW50X3BvaW50cyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgQWN0aW9ucy5hY3Rpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEFjdGlvbnMuYWN0aW9uc1tpXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBBY3Rpb25zLnNob3dBY3Rpb24oQWN0aW9ucy5hY3Rpb25zW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgQWN0aW9ucy5pbml0KCk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBhY3Rpb25DbGljazogQWN0aW9ucy5hY3Rpb25DbGlja1xyXG4gICAgfVxyXG5cclxufSkoKTsiLCJ2YXIgQ2xhc3MgPSAoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuXHJcbiAgICAgICAgaGFzQ2xhc3M6IGZ1bmN0aW9uIChlbGUsY2xzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhIWVsZS5jbGFzc05hbWUubWF0Y2gobmV3IFJlZ0V4cCgnKFxcXFxzfF4pJytjbHMrJyhcXFxcc3wkKScpKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBhZGRDbGFzczogZnVuY3Rpb24oZWxlLGNscykge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuaGFzQ2xhc3MoZWxlLGNscykpIGVsZS5jbGFzc05hbWUgKz0gXCIgXCIrY2xzO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbihlbGUsY2xzKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmhhc0NsYXNzKGVsZSxjbHMpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cCgnKFxcXFxzfF4pJytjbHMrJyhcXFxcc3wkKScpO1xyXG4gICAgICAgICAgICAgICAgZWxlLmNsYXNzTmFtZT1lbGUuY2xhc3NOYW1lLnJlcGxhY2UocmVnLCcgJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKCk7XHJcblxyXG5cclxuXHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
